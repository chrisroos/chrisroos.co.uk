<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <meta name="microid" content="ff511e16d7108be450fccd6f4611cf8d1d5416d1" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta charset="utf-8">
<link rel="icon" href="/images/favicon.gif" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/DeferredUntilInspirationHits" />
<link rel="stylesheet" href="/stylesheets/reset.css" type="text/css" media="all" />
<link rel="stylesheet" href="/stylesheets/congobongo.css" type="text/css" media="all" />
<link rel="openid.server" href="http://www.myopenid.com/server" />
<link rel="openid.delegate" href="http://chrisroos.myopenid.com/" />
<title>Permalinks for del.icio.us bookmarks (posts) - Chris Roos</title>


    
      
        <link rel="prev" href="/blog/2007-08-31-blue-card-user-stories-coming-out-of-the-reevoo-com-feedback" />
      
      
        <link rel="next" href="/blog/2007-09-05-patching-the-del-icio-us-firefox-extension-to-add-permalinks" />
      
      <link rel="first" href="/blog/2005-09-06-linspire" />
      <link rel="last" href="/blog/2015-11-20-confusing-git-log-behaviour" />
      <link rel="index" href="/blog" />
      
    
  <body>
    <div id="page">
      <div id="header" class="group">
        <p id="site_name">
  <a href="/">chris roos</a>
</p>

        <ul class="navigation group">
  <li>
    <a href="/about" title="About me">about me</a>
  </li>
  <li>
    <a href="/contact" title="Contact me">contact me</a>
  </li>
  <li>
    <a href="/blog" title="Blog">blog</a>
  </li>
  <li>
    <a href="/projects" title="Projects">projects</a>
  </li>
  <li>
    <a href="/utilities" title="Utilities">utilities</a>
  </li>
</ul>

        <form id="searchForm" action="http://www.google.co.uk/search">
  <div>
    <input type="hidden" name="q" value="site:chrisroos.co.uk" />
    <input type="text" name="q" size="31" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>

      </div>
      <div id="content">
        <abbr class="createdAt" title="2007-09-04T23:23:00+01:00">Tue, 04 Sep 07</abbr>
        <h1>Permalinks for del.icio.us bookmarks (posts)</h1>
        <p>div(notice). 28-Apr-2009. This is now a firefox extension hosted at
<a href="https://addons.mozilla.org/en-US/firefox/addon/11664">addons.mozilla.org</a>.</p>

<p>I’ve wondered in the
<a href="http://tech.groups.yahoo.com/group/ydn-delicious/message/1447">past</a>
about sending <a href="http://en.wikipedia.org/wiki/Trackback">trackbacks</a> (or
<a href="http://en.wikipedia.org/wiki/Pingback">pingbacks</a>) to bookmarked
resources on <a href="http://del.icio.us">del.icio.us</a>. As with most things, you
can either wait for someone to do it for you, or you can do it yourself…
I started to investigate last Thursday afternoon and soon got sucked
into the much more interesting issue of the missing
<a href="http://en.wikipedia.org/wiki/Permalink">permalinks</a> for bookmarks. You
see, every time you bookmark something on del.icio.us, you are creating
a new
<a href="http://en.wikipedia.org/wiki/Representational_State_Transfer#REST.27s_Central_Principle:_Resources">resource</a>.
Unfortunately, it’s a very sad :-( resource. Sad because it doesn’t have
a <a href="http://www.wikipedia.org/wiki/URL">URL</a> and so can’t be linked to. An
anonymous resource floating around the world wide web looking for love.
Boo hoo. Anyway, enough of that. I figured that if we could assign a
unique tag to each of these resources then they would, as a side effect,
get a permalink (you can already get your bookmarks containing a given
tag by using http://del.icio.us/USERNAME/MY_TAG). I experimented with
using the url as a tag. Although there seem to be some limits on what
you can use, I found that if you strip the protocol and trailing slash
from a url you are generally OK. So, if we bookmark <a href="http://news.bbc.co.uk">BBC
News</a> and tag it with news.bbc.co.uk then we can
access that individual bookmark at
<a href="http://del.icio.us/chrisjroos/news.bbc.co.uk">http://del.icio.us/chrisjroos/news.bbc.co.uk</a>.</p>

<p><a href="http://flickr.com/photos/chrisjroos/1293075032/"><img src="http://farm2.static.flickr.com/1140/1293075032_372cce286d_m.jpg" alt="" /></a></p>

<p>As you can only bookmark the same URL once, it should guarantee that the
url-tag is unique. I can, however, see a problem with the trailing
slash. Although it’s possible to bookmark URLs that differ only in the
trailing slash (http://example.com/article1 and
http://example.com/article1/ for example), it doesn’t seem possible to
create a tag that contains that same trailing slash. OK, so we could
always ensure that we remove the trailing slashes from the URLs we
bookmark but that doesn’t seem like a very robust solution.</p>

<p>While experimenting, I found that I could use forward slashes within my
tags, www.foo.com/bar/baz for example. So, I started prepending url/ to
my url-tag so that I could easily recognise posts that already had
permalinks. It was at this time that I noticed the similarity between
the del.icio.us url history page del.icio.us/url/MD5_OF_URL (e.g. <a href="http://del.icio.us/url/4961e08b5118fbfddec7fb18fa303151">BBC
News</a>) and my
permalinked bookmark, del.icio.us/chrisjroos/url/URL. If I was to
<a href="http://en.wikipedia.org/wiki/MD5">hash</a> the bookmarked url in the same
way as del.icio.us then I would end up with a url like
del.icio.us/chrisjroos/url/MD5_OF_URL. You can see the similarity in
the URLs below.</p>

<ul>
  <li><a href="http://del.icio.us/chrisjroos/url/4961e08b5118fbfddec7fb18fa303151">http://del.icio.us/chrisjroos/url/4961e08b5118fbfddec7fb18fa303151</a></li>
  <li><a href="http://del.icio.us/url/4961e08b5118fbfddec7fb18fa303151">http://del.icio.us/url/4961e08b5118fbfddec7fb18fa303151</a></li>
</ul>

<p>It looks as though it’s part of del.icio.us itself doesn’t it? Cool huh.
It’d be really cool to extend the del.icio.us
<a href="http://www.mozilla.com/en-US/firefox/">firefox</a>
<a href="https://addons.mozilla.org/en-US/firefox/addon/1532">extension</a> to
automatically add this tag when bookmarking a site.</p>

<p>I’ve created a crappy script that will add this url/MD5_OF_URL tag to
each of your posts. It’s hosted on <a href="http://chrisroos.googlecode.com/svn/trunk/delicious_url_tags">google
code</a> and
pasted below. Err, use at your own risk by the way.</p>

<p>``` code
USERNAME = ‘YOUR_USERNAME’
PASSWORD = ‘YOUR_PASSWORD’
POSTS_CACHE = ‘FILE_TO_STORE_YOUR_EXISTING_DELICIOUS_POSTS_IN’</p>

<h1>GET ALL POSTS</h1>
<p>unless File.exists?(POSTS_CACHE)
  puts “Downloading all posts…”
  curl_cmd = «-EndCurl
curl “https://api.del.icio.us/v1/posts/all” \
-u”#{USERNAME}:#{PASSWORD}” \
-s
&gt; #{POSTS_CACHE}
  EndCurl
  <code>#{curl_cmd}</code>
end</p>

<p>require ‘hpricot’
require ‘md5’
require ‘cgi’</p>

<p>def add_url_hash_to_post(post)
  url = CGI.unescapeHTML(post[‘href’])
  url_hash = MD5.md5(url)
  url = CGI.escape(url)</p>

<p>tags = post[‘tag’].split(‘ ‘).collect { |tag| CGI.unescapeHTML(tag) }
  tags « “url/#{url_hash}” unless tags.include?(“url/#{url_hash}”)
  tags = tags.collect { |tag| CGI.escape(tag) }
  tags = tags.join(‘ ‘)</p>

<p>shared = post[‘shared’]
  description = CGI.escape(CGI.unescapeHTML(post[‘description’]))
  extended = CGI.escape(CGI.unescapeHTML(post[‘extended’]))</p>

<p>curl_cmd = «-EndCurl
curl “https://api.del.icio.us/v1/posts/add” \
-u”#{USERNAME}:#{PASSWORD}” \
-d”url=#{url}” \
-d”description=#{description}” \
-d”extended=#{extended}” \
-d”tags=#{tags}” \
-d”shared=#{shared}” \
-s
  EndCurl
  <code>#{curl_cmd}</code>
end</p>

<h1>ADD THE URL/<md5_hash> TAG TO EACH POST</md5_hash></h1>
<p>posts_xml = File.open(POSTS_CACHE) { |f| f.read }
posts_doc = Hpricot(posts_xml)
count = 1
(posts_doc/’posts’/’post’).each do |post_xml|
  puts “Bookmark: #{count}” if (count % 5) == 0
  add_url_hash_to_post(post_xml.attributes)
  count += 1
end
```</p>


        <hr />
        
  <ul class="navigation group">
    
      <li class="previousPost">
        &laquo; (older)
        <a class="previousPost" rel="prev" href="/blog/2007-08-31-blue-card-user-stories-coming-out-of-the-reevoo-com-feedback" title="Blue card user stories coming out of the reevoo.com feedback">
          Blue card user stories coming out of the reevoo.com feedback
        </a>
      </li>
    

    
      <li class="nextPost">
        <a class="nextPost" rel="next" href="/blog/2007-09-05-patching-the-del-icio-us-firefox-extension-to-add-permalinks" title="Patching the del.icio.us firefox extension to add permalinks">
          Patching the del.icio.us firefox extension to add permalinks
        </a>
        (newer) &raquo;
      </li>
    
  </ul>


      </div>
      <div id="footer">
        <p class="license">
  <a rel="license" href="http://creativecommons.org/licenses/by/2.0/uk/">
    <img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/2.0/uk/80x15.png" />
  </a>
  <span xmlns:dc="http://purl.org/dc/elements/1.1/" href="http://purl.org/dc/dcmitype/Text" property="dc:title" rel="dc:type">
    deferred until inspiration hits
  </span>
  by
  <span class="vcard">
    <a xmlns:cc="http://creativecommons.org/ns#" href="/contact" property="cc:attributionName" rel="cc:attributionURL" class="url fn">
      Chris Roos
    </a>
  </span>
  is licensed under a
  <a rel="license" href="http://creativecommons.org/licenses/by/2.0/uk/">
    Creative Commons Attribution 2.0 UK: England &amp; Wales License
  </a>
</p>

      </div>
    </div>
    <script src="/javascripts/google-custom-search.js" type="text/javascript" charset="utf-8"></script>
  </body>
</html>
