<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="ff511e16d7108be450fccd6f4611cf8d1d5416d1" name="microid" />
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta charset="utf-8" />
    <link href="/images/favicon.gif" rel="icon" />
    <link href="http://feeds.feedburner.com/DeferredUntilInspirationHits" rel="alternate" title="RSS" type="application/rss+xml" />
    <link href="/stylesheets/reset.css" media="all" rel="stylesheet" type="text/css" />
    <link href="/stylesheets/congobongo.css" media="all" rel="stylesheet" type="text/css" />
    <link href="http://www.myopenid.com/server" rel="openid.server" />
    <link href="http://chrisroos.myopenid.com/" rel="openid.delegate" />
    <title>Creating a Greasemonkey Script That Applies to the Firefox 'Problem Loading Page' Error Page - Chris Roos</title>
    <link href="/blog/2009-06-24-down-for-everyone-or-just-me-greasemonkey-script" rel="prev" />
    <link href="/blog/2009-09-14-pouring-factlets-into-your-brain-holder-via-your-ear-sieves" rel="next" />
    <link href="/blog/2005-09-06-linspire" rel="first" />
    <link href="/blog/2015-11-20-confusing-git-log-behaviour" rel="last" />
    <link href="/blog" rel="index" />
    <meta content="Some notes about applying a greasemonkey script to the Firefox 'Problem Loading Page' error page." name="description" />
  </head>
  <body>
    <div id="page">
      <div class="group" id="header">
        <p id="site_name">
          <a href="/">chris roos</a>
        </p>
        <ul class="navigation group">
          <li>
            <a href="/about" title="About me">about me</a>
          </li>
          <li>
            <a href="/contact" title="Contact me">contact me</a>
          </li>
          <li>
            <a href="/blog" title="Blog">blog</a>
          </li>
          <li>
            <a href="/projects" title="Projects">projects</a>
          </li>
          <li>
            <a href="/utilities" title="Utilities">utilities</a>
          </li>
        </ul>
        <form action="http://www.google.co.uk/search" id="searchForm">
          <div>
            <input name="q" type="hidden" value="site:chrisroos.co.uk" />
            <input name="q" size="31" type="text" />
            <input name="sa" type="submit" value="Search" />
          </div>
        </form>
      </div>
      <div id="content">
        <abbr class="createdAt" title="2009-07-21T06:50:54+00:00">Tue, 21 Jul 09</abbr>
        <h1>Creating a Greasemonkey Script That Applies to the Firefox 'Problem Loading Page' Error Page</h1>
        <p>I found a few things when developing the <a href="/blog/2009-06-24-down-for-everyone-or-just-me-greasemonkey-script">down for everyone</a> greasemonkey script that might be of use to someone else wanting to customise the &#8216;Problem loading page&#8217; error page.</p>
        <p>I originally based my script on this <a href="http://userscripts.org/scripts/show/4125">Server not found? Try and try again</a> script.  Specifically, I used something like this to determine whether or not the error page was being displayed.</p>
        <pre class="code javascript">
          if (document.documentURI.substr(0,14)=="about:neterror") {
        </pre>
        <p>Given this I was able to find, and use, this similar code from <a href="chrome://browser/content/browser.js">chrome://browser/content/browser.js</a> (paste that link into the location bar and search for about:neterror or the aboutNeterror constant).</p>
        <pre class="code javascript">
          if (/^about:neterror/.test(document.documentURI)) {
        </pre>
        <p>I&#8217;m still not exactly sure of the purpose of document.documentURI except that it appears to allow you to display one URI and actually render another (in this case it displays the URI you&#8217;re trying to access but renders the error page).  This error page also appears to screw with <a href="http://getfirebug.com">firebug</a>.  If you want to see the value of documentURI you&#8217;ll need to use this little bit of javascript in the location bar:</p>
        <pre class="code javascript">
          javascript:alert(document.documentURI);
        </pre>
        <p>It turns out that you can&#8217;t directly view the source of the &#8216;Problem loading page&#8217; error page: Press Ctrl-U, or select View &gt; Page Source from the menu, and you&#8217;ll be presented with the error page in a popup window.  In order to view the source you&#8217;ll need to load it, using the chrome protocol, from <a href="chrome://global/content/netError.xhtml">chrome://global/content/netError.xhtml</a> (paste that into the location bar).  The error page (which lives in firefox-dir/chrome/toolkit.jar/content/global/netError.xhtml) is pretty empty as it uses javascript to read querystring parameters and populate it on the fly.  This allows the same error page to be used for multiple types of error.  You can see an example of changing the description in this link: <a href="chrome://global/content/netError.xhtml?e=dnsNotFound&amp;u=http%3A//example.com&amp;d=I%20can%20see%20you...">about:neterror?e=dnsNotFound&amp;u=http%3A//example.com&amp;d=I%20can%20see%20you&#8230;</a> (paste that link into the location bar).</p>
        <p>I initially tried to add a button next to the &#8216;Try Again&#8217; button that appears on the page.  My first attempt was to create a xul:button (which is the type of the &#8216;Try Again&#8217; button) but that didn&#8217;t work.  I don&#8217;t remember the exact details but I don&#8217;t think I was able to get addEventListener working in order to attach events to the button.  I was able to create a standard html button but the xul.css stylesheet didn&#8217;t get applied and it therefore looked odd next to the &#8216;Try Again&#8217; button.  Comments in the source of the <a href="http://userscripts.org/scripts/review/4125">Server not found? Try and try again</a> script lead me to believe that the developer of that script ran into these same problems with the button.</p>
        <p>While digging through the firefox source files I noticed a few files that I found interesting/amusing and hadn&#8217;t come across before: <a href="about:mozilla">about:mozilla</a>, <a href="about:robots">about:robots</a> and <a href="about:crashes">about:crashes</a> (I&#8217;m not sure why but this link doesn&#8217;t appear to work directly, copy and paste it to the location bar to see the page).</p>
        <hr />
        <ul class="navigation group">
          <li class="previousPost">
            &laquo; (older)
            <a class="previousPost" href="/blog/2009-06-24-down-for-everyone-or-just-me-greasemonkey-script" rel="prev" title="Down for Everyone or Just Me Greasemonkey Script">
              Down for Everyone or Just Me Greasemonkey Script
            </a>
          </li>
          <li class="nextPost">
            <a class="nextPost" href="/blog/2009-09-14-pouring-factlets-into-your-brain-holder-via-your-ear-sieves" rel="next" title="Pouring Factlets Into Your Brain Holder via Your Ear Sieves">
              Pouring Factlets Into Your Brain Holder via Your Ear Sieves
            </a>
            (newer) &raquo;
          </li>
        </ul>
      </div>
      <div id="footer">
        <p class="license">
          <a href="http://creativecommons.org/licenses/by/2.0/uk/" rel="license">
            <img alt="Creative Commons License" src="http://i.creativecommons.org/l/by/2.0/uk/80x15.png" style="border-width:0" />
          </a>
          <span href="http://purl.org/dc/dcmitype/Text" property="dc:title" rel="dc:type" xmlns:dc="http://purl.org/dc/elements/1.1/">deferred until inspiration hits</span>
          by
          <span class="vcard">
            <a class="url fn" href="/contact" property="cc:attributionName" rel="cc:attributionURL" xmlns:cc="http://creativecommons.org/ns#">Chris Roos</a>
          </span>
          is licensed under a
          <a href="http://creativecommons.org/licenses/by/2.0/uk/" rel="license">Creative Commons Attribution 2.0 UK: England &amp; Wales License</a>
        </p>
      </div>
    </div>
    <script charset="utf-8" src="/javascripts/google-custom-search.js" type="text/javascript"></script>
  </body>
</html>
